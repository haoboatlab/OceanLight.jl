<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Photons at the center · OceanLight.jl</title><meta name="title" content="Photons at the center · OceanLight.jl"/><meta property="og:title" content="Photons at the center · OceanLight.jl"/><meta property="twitter:title" content="Photons at the center · OceanLight.jl"/><meta name="description" content="Documentation for OceanLight.jl."/><meta property="og:description" content="Documentation for OceanLight.jl."/><meta property="twitter:description" content="Documentation for OceanLight.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">OceanLight.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Quick Start</span><ul><li class="is-active"><a class="tocitem" href>Photons at the center</a><ul class="internal"><li><a class="tocitem" href="#Initial-Condition"><span>Initial Condition</span></a></li><li><a class="tocitem" href="#Initialize-Parameters"><span>Initialize Parameters</span></a></li><li><a class="tocitem" href="#Air-Water-Interaction-2"><span>Air-Water Interaction</span></a></li><li><a class="tocitem" href="#Monte-Carlo-simulation-2"><span>Monte Carlo simulation</span></a></li></ul></li></ul></li><li><span class="tocitem">Module</span><ul><li><a class="tocitem" href="../../module/Parameters/">Parameters</a></li><li><a class="tocitem" href="../../module/refraction/">Refraction</a></li><li><a class="tocitem" href="../../module/MonteCarlo/">Monte Carlo Simulation</a></li></ul></li><li><span class="tocitem">Simulation</span><ul><li><a class="tocitem" href="../../Simulation/ModelSetup/">Model Setup</a></li><li><a class="tocitem" href="../../Simulation/AirWaveInteract/">Air-Water Interaction</a></li><li><a class="tocitem" href="../../Simulation/WithinWater/">Light within Water</a></li><li><a class="tocitem" href="../../Simulation/Exporting/">Exporting data</a></li></ul></li><li><a class="tocitem" href="../../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Quick Start</a></li><li class="is-active"><a href>Photons at the center</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Photons at the center</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/haoboatlab/OceanLight.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/haoboatlab/OceanLight.jl/blob/main/docs/src/QuickStart/Center.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Quick-Start"><a class="docs-heading-anchor" href="#Quick-Start">Quick Start</a><a id="Quick-Start-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Start" title="Permalink"></a></h1><p>In this example, we introduce the <code>OceanLight</code> calculation of downwelling irradiance field underneath the flat surfcae. The code example here can be directly pasted onto Julia terminal, run through <code>.jl</code> script file, or IJulia notebook. </p><p>First, we import <code>OceanLight</code> packages and another <code>random</code> dependent package, that will be used as a seed to generate random number in the Monte Carlo simulation.</p><pre><code class="language-julia hljs">using OceanLight
using Random</code></pre><h2 id="Initial-Condition"><a class="docs-heading-anchor" href="#Initial-Condition">Initial Condition</a><a id="Initial-Condition-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-Condition" title="Permalink"></a></h2><p>OceanLight accesses all input variables in <code>.yml</code> format and stores their values in <code>Param</code> structure.</p><p>All input variables required by OceanLight can be separated into 3 categories:</p><ol><li><strong>Irradiance:</strong> Setting up the dimension of downwelling irradiance field calculation grid. </li><li><strong>Photon:</strong> Number of Photons and optical properties of the water.</li><li><strong>Wave:</strong> Structure of surface wave field. </li></ol><pre><code class="language-julia hljs"># irradiance
nz = 200
dz = 1
nxe = 512
nye = 512
num = 31
ztop = 10
# photon
nphoton = 100000
kr = 10
nxp = 512
kbc = 0
b = 0.006
nyp = 512
a = 0.007
# wave
pey = 0.07853981633974483
nxeta = 512
nyeta = 512
pex = 0.07853981633974483</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.07853981633974483</code></pre><p>To create a input variable file suitable for this package, user can either create a new file in <code>.yml</code> format, copy, and paste the code block above, or using a build-in function <code>OceanLihgt.writeparams</code> to automate the process. </p><p>The function <code>writeparams</code> converts the dictionary of input variables into the <code>light.yml</code> file. </p><pre><code class="language-julia hljs">data=Dict(&quot;irradiance&quot;=&gt;Dict(&quot;nxe&quot;=&gt;nxe,&quot;nye&quot;=&gt;nye,&quot;nz&quot;=&gt;nz,&quot;dz&quot;=&gt;dz,&quot;ztop&quot;=&gt;ztop,&quot;num&quot;=&gt;num),
            &quot;wave&quot;=&gt;Dict(&quot;pex&quot;=&gt;pex,&quot;pey&quot;=&gt;pey,&quot;nxeta&quot;=&gt;nxeta,&quot;nyeta&quot;=&gt;nyeta),
            &quot;photon&quot;=&gt;Dict(&quot;nxp&quot;=&gt;nxp,&quot;nyp&quot;=&gt;nyp,&quot;nphoton&quot;=&gt;nphoton,&quot;a&quot;=&gt;a,&quot;b&quot;=&gt;b,&quot;kr&quot;=&gt;kr,&quot;kbc&quot;=&gt;kbc))

OceanLight.writeparams(data)</code></pre><p>Once the input variable file is generated, this package calculates other related variables and stores all values in the <code>Param</code> structure, through <code>OceanLight.readparams</code>. The default input variable file name that will be read is <code>light.yml</code>, but can be specified by users. In this case, we store <code>Param</code> structure in variable <code>p</code>. </p><pre><code class="language-julia hljs">p = OceanLight.readparams()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Param(513, 513, 512, 512, 31, 200, [0.0, 0.15625, 0.3125, 0.46875, 0.625, 0.78125, 0.9375, 1.09375, 1.25, 1.40625  …  78.59375, 78.75, 78.90625, 79.0625, 79.21875, 79.375, 79.53125, 79.6875, 79.84375, 80.0], [0.0, 0.15625, 0.3125, 0.46875, 0.625, 0.78125, 0.9375, 1.09375, 1.25, 1.40625  …  78.59375, 78.75, 78.90625, 79.0625, 79.21875, 79.375, 79.53125, 79.6875, 79.84375, 80.0], [9.0, 8.0, 7.0, 6.0, 5.0, 4.0, 3.0, 2.0, 1.0, 0.0  …  -181.0, -182.0, -183.0, -184.0, -185.0, -186.0, -187.0, -188.0, -189.0, -190.0], 0.07853981633974483, 0.07853981633974483, 0.15625, 0.15625, 1.0, 10.0, 0.0, 80.0, 0.0, 80.0, 80.0, 80.0, 513, 513, 512, 512, 512, 512, 100000, 0, 0.007, 0.006, 10.0, 0.15625, 0.15625)</code></pre><h2 id="Initialize-Parameters"><a class="docs-heading-anchor" href="#Initialize-Parameters">Initialize Parameters</a><a id="Initialize-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Initialize-Parameters" title="Permalink"></a></h2><p>Before the simulation, user needs to declare and initialize all parameters and their dimensions. </p><h3 id="Air-Water-Interaction"><a class="docs-heading-anchor" href="#Air-Water-Interaction">Air-Water Interaction</a><a id="Air-Water-Interaction-1"></a><a class="docs-heading-anchor-permalink" href="#Air-Water-Interaction" title="Permalink"></a></h3><p>During the light refraction between two mediums calculation, <code>OceanLight</code> requires the surface elevation attribution: <span>$\eta$</span>; surface elevation, <span>$\eta_{x}$</span>; partial derivative of <span>$\eta$</span> in x direction, and <span>$\eta_{y}$</span>; partial derivative of <span>$\eta$</span> in y direction. All surface elevation distribution, as specified above, need to have the same dimension with the incoming photons&#39; grid. Hence, </p><pre><code class="language-julia hljs">η = zeros(p.nxs,p.nys)
ηx = zeros(p.nxs,p.nys)
ηy = zeros(p.nxs,p.nys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">513×513 Matrix{Float64}:
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 ⋮                        ⋮              ⋱                      ⋮         
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0</code></pre><p>After photons&#39; interaction with the surface, OceanLight requires the information of specific coordinate of photon in cartesian grid <span>${xpb,ypb,zpb}$</span>, the direction in which photon will travel in polar coordinate <span>${θ,ϕ}$</span>, and the fraction of light that transmit through the water <span>${fres}$</span>: all in the dimension of incoming photon grid size. </p><pre><code class="language-julia hljs">xpb = zeros(p.nxp,p.nyp);
ypb = zeros(p.nxp,p.nyp);
zpb = zeros(p.nxp,p.nyp);
θ = zeros(p.nxp,p.nyp);
ϕ = zeros(p.nxp,p.nyp);
fres = zeros(p.nxp,p.nyp);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">512×512 Matrix{Float64}:
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 ⋮                        ⋮              ⋱  ⋮                        ⋮    
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0</code></pre><h3 id="Monte-Carlo-simulation"><a class="docs-heading-anchor" href="#Monte-Carlo-simulation">Monte Carlo simulation</a><a id="Monte-Carlo-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Monte-Carlo-simulation" title="Permalink"></a></h3><p><code>OceanLight</code> tracks the path of each photon travelling inside the water medium and store the irradiance value in the grid <code>ed</code>. </p><p>Users need to specify these variables and corresponding dimension. </p><pre><code class="language-julia hljs">ed = zeros(p.nx, p.ny, p.nz)
esol = zeros(p.num, p.nz)
randrng = MersenneTwister(1234)
area = zeros(4)
interi = zeros(Int64,4)
interj = zeros(Int64,4)
ix = div(p.nxη,2)+1
iy = div(p.nyη,2)+1
ϕps,θps = OceanLight.phasePetzold()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.517, 0.666, 0.751, 0.811, 0.851, 0.879, 0.901, 0.918, 0.931, 0.942  …  0.995, 0.996, 0.9968, 0.9976, 0.9982, 0.9988, 0.9992, 0.9997, 0.9998, 1.0], [0.04363323129985824, 0.1308996938995747, 0.2181661564992912, 0.30543261909900765, 0.39269908169872414, 0.4799655442984406, 0.5672320068981571, 0.6544984694978736, 0.7417649320975901, 0.8290313946973066  …  2.3125612588924866, 2.399827721492203, 2.48709418409192, 2.5743606466916362, 2.6616271092913526, 2.748893571891069, 2.8361600344907854, 2.9234264970905017, 3.0106929596902186, 3.097959422289935])</code></pre><h2 id="Air-Water-Interaction-2"><a class="docs-heading-anchor" href="#Air-Water-Interaction-2">Air-Water Interaction</a><a class="docs-heading-anchor-permalink" href="#Air-Water-Interaction-2" title="Permalink"></a></h2><p>During the air-water interaction process, OceanLight simulates the photons transfer directly downward from the air side, interacts with the water surface, and transfer down into water medium. </p><p>User can generate random surface elevation attribution <span>${\eta,\eta_{x},\eta_{y}}$</span> with <code>OceanLight.setwave!</code>, or provided specific data <span>${\eta_{0},\eta_{x0},\eta_{y0}}$</span>  . OceanLight can map the user&#39;s provided data of <span>${\eta_{0},\eta_{x0},\eta_{y0}}$</span>, which might have different dimension onto the suitable dimension of input value <span>${η,ηx,ηy}$</span> with <code>OceanLight.convertwave!</code>.</p><p>In this example, we will consider the case of flat surface elevation. Hence, <span>${η,ηx,ηy}$</span> is equal to the matrix of zeros. </p><p>Once all the input variables are in place, <code>OceanLight.interface!</code> calculate the refraction of the light between two medium given surface elevation attribution and return the position, reflectance angle, and transmission ratio. </p><pre><code class="language-julia hljs">OceanLight.interface!(xpb,ypb,zpb,θ,ϕ,fres,η,ηx,ηy,p)</code></pre><h2 id="Monte-Carlo-simulation-2"><a class="docs-heading-anchor" href="#Monte-Carlo-simulation-2">Monte Carlo simulation</a><a class="docs-heading-anchor-permalink" href="#Monte-Carlo-simulation-2" title="Permalink"></a></h2><p><code>OceanLight</code> simulates the photon traveling inside the water medium, given its initial position <span>${xpb,ypb,zpb}$</span> and the direction it started with<span>${θ,ϕ}$</span>. Once photons are inside the water, <code>OceanLight</code> will track its path, governed by its probability distribution and the attenuated coefficient input, and store the irradiance value in the grid <code>ed</code>. </p><p>The <code>transfer!</code> function simulate a single photon path and store its landed position on the grid <code>ed</code>. Hence, to simulate multiple photons, users need to loop the <code>transfer!</code> function and giving the input of an individual photon&#39;s number <code>ip</code>. Thus, <code>OceanLight</code> could facilitate parallel computation. </p><pre><code class="language-julia hljs">for ip = 1:p.nphoton
    OceanLight.transfer!(ed,esol,θ[ix,iy],ϕ[ix,iy],fres[ix,iy],ip,xpb[ix,iy],
        ypb[ix,iy],zpb[ix,iy],area,interi,interj,randrng,η,ϕps,θps,p,1)
end</code></pre><p>Lastly, once the field <code>ed</code> is obtained. The <code>applybc!</code> apply and ensure the boundary condition of the <code>ed</code>. </p><pre><code class="language-julia hljs">OceanLight.applybc!(ed,p)</code></pre><p>Once the simulation is over, the downwelling irradiance field <span>$I(x,y,z)$</span> is stored in variable <code>ed</code>. To export the data, the build-in function <code>OceanLight.exported</code> export data and its statistical information in to <code>.h5</code> format, depended on the path given by user. </p><p>The result downwelling irradiance field <span>$I(x,y,z)$</span> is in 3 dimension tensor, where the first two dimensions represent horizontal field, and the last represents the vertical field or depth. The first few depth layer represents the air phase, hence <span>$I(x,y,z)$</span> is zeros, depending on how many layer specified as air phases <code>ztop</code>. To visualize using <code>Plots</code> julia package, users can try the example code below. </p><pre><code class="language-julia hljs">using Plots
using Plots.Measures

l = @layout [grid(2,1) a{0.5w} ; b{0.5w}]

p1 = heatmap(p.x,p.y,log.(ed[:,:,40]),clim=(-20,20),framestyle = :box,grid = false, c =cgrad(:viridis)
    ,ylimits=(-40,40),xlimits=(-40,40),legend = :none,xlabel=&quot;\$x(m)\$&quot;,ylabel=&quot;\$y(m)\$&quot;)
p2 = heatmap(p.x,p.y,log.(ed[:,:,160]),clim=(-20,20),framestyle = :box,grid = false, c =cgrad(:viridis)
    ,ylimits=(-40,40),xlimits=(-40,40),legend = :none,xlabel=&quot;\$x(m)\$&quot;,ylabel=&quot;\$y(m)\$&quot;)
p3 = heatmap(p.x,p.z,reverse(transpose(log.(ed[:,256,:]))),clim=(-20,20),framestyle = :box,grid = false, c =cgrad(:viridis)
    ,ylimits=(-190,10),xlimits=(-40,40),xlabel=&quot;\$x(m)\$&quot;,ylabel=&quot;\$z(m)\$&quot;
    ;cbar_title=&quot;\$\\ln(I(x,y,z))\$&quot;)
plot(p1, p2,p3, layout = l,
title = [&quot;($i)&quot; for j in 1:1, i in [&quot;a&quot;,&quot;b&quot;,&quot;c&quot;]], titleloc = :left, titlefont = font(8)
,left_margin = [10mm 0mm],right_margin = [10mm 0mm])
plot!(size=(900,1200))</code></pre><img src="dd05ba0f.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../../module/Parameters/">Parameters »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 30 January 2025 05:23">Thursday 30 January 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
